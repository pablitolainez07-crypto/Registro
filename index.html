<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Sistema de Registro - Laboratorios</title>

<style>
body{
  font-family:'Segoe UI',Tahoma,sans-serif;
  background:linear-gradient(135deg,#1d2671,#c33764);
  margin:0;padding:0;
}
.login,.app{
  max-width:1200px;
  margin:40px auto;
  background:white;
  padding:25px;
  border-radius:16px;
  box-shadow:0 10px 25px rgba(0,0,0,.2);
}
h2{text-align:center}
input{
  width:100%;
  padding:12px;
  margin:12px 0;
  border-radius:8px;
  border:1px solid #ccc;
}
button{
  padding:10px 18px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  color:white;
  font-weight:bold;
}
.btn-green{background:#2ecc71}
.btn-yellow{background:#f1c40f;color:black}
.btn-red{background:#e74c3c}
.toolbar{text-align:center;margin-bottom:20px}
.toolbar button{margin:0 6px}
.content{
  display:grid;
  grid-template-columns:1fr 1fr 300px;
  gap:20px;
}
table{
  width:100%;
  border-collapse:collapse;
  background:#f9f9f9;
}
th,td{
  border:1px solid #ccc;
  padding:10px;
  text-align:center;
  cursor:pointer;
}
th{background:#34495e;color:white}
td span{font-size:12px;font-weight:bold}
.lab-title{text-align:center;font-weight:bold;margin-bottom:6px}
textarea{
  width:100%;
  height:250px;
  padding:12px;
  border-radius:10px;
  resize:none;
}
.tooltip{
  position:absolute;
  background:rgba(0,0,0,.85);
  color:white;
  padding:8px 12px;
  border-radius:6px;
  font-size:13px;
  max-width:260px;
  display:none;
  z-index:1000;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="login" id="loginBox">
<h2>Iniciar Sesi√≥n</h2>
<input id="user" placeholder="Usuario">
<input id="pass" type="password" placeholder="Contrase√±a">
<button class="btn-green" onclick="login()">Entrar</button>
<p id="error" style="color:red;text-align:center;display:none;font-weight:bold;"></p>
</div>

<!-- APP -->
<div class="app" id="appBox" style="display:none">
<h2 id="welcome"></h2>

<div class="toolbar">
<button class="btn-green" onclick="setColor('#2ecc71')">Desocupado</button>
<button class="btn-yellow" onclick="setColor('#f1c40f')">Reservado</button>
<button class="btn-red" onclick="setColor('#e74c3c')">Ocupado</button>
</div>

<div class="content">

<div>
<div class="lab-title">Laboratorio 1</div>
<table class="schedule">
<tr><th>Hora</th><th>Lunes</th><th>Martes</th><th>Mi√©rcoles</th><th>Jueves</th><th>Viernes</th></tr>
<tr><th>07:20</th><td></td><td></td><td></td><td></td><td></td></tr>
<tr><th>08:25</th><td></td><td></td><td></td><td></td><td></td></tr>
<tr><th>10:00</th><td></td><td></td><td></td><td></td><td></td></tr>
</table>
</div>

<div>
<div class="lab-title">Laboratorio 2</div>
<table class="schedule">
<tr><th>Hora</th><th>Lunes</th><th>Martes</th><th>Mi√©rcoles</th><th>Jueves</th><th>Viernes</th></tr>
<tr><th>07:20</th><td></td><td></td><td></td><td></td><td></td></tr>
<tr><th>08:25</th><td></td><td></td><td></td><td></td><td></td></tr>
<tr><th>10:00</th><td></td><td></td><td></td><td></td><td></td></tr>
</table>
</div>

<div>
<h3>Descripci√≥n</h3>
<textarea id="descBox" placeholder="Selecciona un casillero..."></textarea>
</div>

</div>
</div>

<div id="tooltip" class="tooltip"></div>

<script>
const USERS={
  "DannayErick":"12345",
  "Pablo Lainez":"098765"
};

let currentUser="";
let selectedColor=null;
let selectedCell=null;
const tooltip=document.getElementById("tooltip");

// LOGIN
function login(){
  if(USERS[user.value]===pass.value){
    currentUser=user.value;
    loginBox.style.display="none";
    appBox.style.display="block";
    welcome.textContent="Bienvenido: "+currentUser;
    loadData();
  }else{
    error.textContent="Usuario o contrase√±a incorrectos";
    error.style.display="block";
  }
}

function setColor(c){selectedColor=c;}

// GUARDAR / CARGAR
function saveData(){
  const data=[];
  document.querySelectorAll(".schedule td").forEach((cell,i)=>{
    data[i]={
      color:cell.style.backgroundColor,
      html:cell.innerHTML,
      desc:cell.getAttribute("data-desc")
    };
  });
  localStorage.setItem("labsData",JSON.stringify(data));
}

function loadData(){
  const data=JSON.parse(localStorage.getItem("labsData"));
  if(!data)return;
  document.querySelectorAll(".schedule td").forEach((cell,i)=>{
    if(data[i]){
      cell.style.backgroundColor=data[i].color||"";
      cell.innerHTML=data[i].html||"";
      if(data[i].desc) cell.setAttribute("data-desc",data[i].desc);
      else cell.removeAttribute("data-desc");
    }
  });
}

// CASILLEROS
document.querySelectorAll(".schedule td").forEach(cell=>{
  cell.onclick=()=>{
    if(!selectedColor) return alert("Selecciona un estado");
    selectedCell=cell;

    if(selectedColor==="#2ecc71"){
      cell.style.background=selectedColor;
      cell.innerHTML="";
      cell.removeAttribute("data-desc");
      descBox.value="";
      saveData();
      return;
    }

    const nombre=prompt("Nombre:");
    if(!nombre)return;

    cell.style.background=selectedColor;
    cell.innerHTML="<span>"+nombre+"</span>";
    descBox.value="";
    descBox.focus();
    saveData();
  };

  cell.onmouseenter=e=>{
    const d=cell.getAttribute("data-desc");
    if(d){
      tooltip.textContent=d;
      tooltip.style.display="block";
      tooltip.style.left=e.pageX+10+"px";
      tooltip.style.top=e.pageY+10+"px";
    }
  };
  cell.onmousemove=e=>{
    tooltip.style.left=e.pageX+10+"px";
    tooltip.style.top=e.pageY+10+"px";
  };
  cell.onmouseleave=()=>tooltip.style.display="none";
});

// DESCRIPCI√ìN
descBox.oninput=()=>{
  if(selectedCell){
    selectedCell.setAttribute("data-desc",descBox.value);
    saveData();
  }
};

// üîÑ SINCRONIZACI√ìN ENTRE USUARIOS
window.addEventListener("storage",e=>{
  if(e.key==="labsData"){
    loadData();
  }
});
</script>

</body>
</html>

